syntax = "proto3";

option go_package = "github.com/idastroem/swupdatesvc";
option java_multiple_files = true;
option java_package = "de.idastroem.swupdatesvc";
option java_outer_classname = "SwUpdateSvc";

package swupdate;

service Updater {
    rpc CheckForUpdate(CheckForUpdateRequest) returns (stream CheckForUpdateResponse) {}
    rpc ExecuteUpdate(UpdateRequest) returns (stream UpdateResponse) {}
    rpc Reboot(Empty) returns (Empty) {}
}

message Empty {
}

message CheckForUpdateRequest {
    string updateUrl = 1;
    string password = 2;
}

message CheckForUpdateResponse {
    string engineVersion = 1;
    bool isOkay = 2;
    string errorMessage = 3;
    map<string,string> userData = 4;
}

message UpdateRequest {
}

message UpdateResponse {
    float progress = 1;
    bool done = 2;
    string msg = 3;
}
